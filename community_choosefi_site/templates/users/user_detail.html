{% extends "coderedcms/pages/home_page.html" %}

{% load static %}

{% block title %}User: {{ object.username }}{% endblock %}

{% block content_body %}
<div class="container">

  <div class="row">
    <div class="col-8">

      <div>
      <h2>User: {{ object.username }}</h2>
      {% if object.name %}
        <p>{{ object.name }}</p>
      {% endif %}
      </div>

      {% if user.username == object.username or object.share_group_memberships %}
      <div>
      <h3>Local Group Memberships</h3>
      <ul>
        {% for group in object.local_groups.all %}
          <li><a href="{{ group.url }}">{{ group }}</a></li>
        {% empty %}
          <li><em>no local group memberships</em></li>
        {% endfor %}
      </ul>
      </div>

      <div>
      <h3>Topic/Interest List Memberships</h3>
      <ul>
        {% for group in object.topic_groups.all %}
          <li><a href="{{ group.url }}">{{ group }}</a></li>
        {% empty %}
          <li><em>no topic group memberships</em></li>
        {% endfor %}
      </ul>
      </div>
      {% endif %}

      <div class="ribbon-container">
        <div class="ribbon orange-ribbon">
          <!-- tools, hammer, -->
          <span><i class="fas fa-star-half-alt"></i> Upcoming</span>
        </div>
      <h3>Mailing Lists/Newsletter Subscriptions</h3>
      <p>This will list all of our public newsletter and mailing list offerings
        (e.g. Travel, Spanish, Weekly news, etc) and allow users to easily
        subscribe/unsubscribe.
      </p>
      </div>

      <div>
      <h3>Upcoming Events</h3>
      <ul>
        {% for event in object.upcoming_events %}
          {% with event.next_occurrence as occurrence %}
            {% with start_datetime=occurrence.0  end_datetime=occurrence.1  occurrence_obj=occurrence.2 %}
            {%  if occurrence %}{# events in the past return None on 'next_occurrence' #}
            <li>
              {{ start_datetime }} -
                <a href="{{ event.url }}">{{ event.title }}</a>
                {% with parent_group=event.get_parent %}
                (<a href="{{ parent_group.url }}">{{ parent_group }}</a>)
                {% endwith %}
                {% if occurrence_obj.repeat %}
                  (repeats <em>{{ occurrence_obj.repeat|cut:"RRULE:FREQ="|lower }}</em>)
                {% endif %}
            </li>
            {%  endif %}
            {% endwith %}
          {% endwith %}
        {% endfor %}
      </ul>
      </div>

    </div>

    {% if object == request.user %}
    <!-- Action buttons -->
    <div class="col-4">
      <h4>Profile Actions</h4>
        <a class="btn btn-primary" href="{% url 'users:update' %}" role="button">Update Profile Info</a>
        <a class="btn btn-primary" href="{% url 'account_email' %}" role="button">Update E-Mail</a>
        <!-- Your Stuff: Custom user template urls -->
    </div>
    <!-- End Action buttons -->
    {% endif %}

  </div>


</div>
{% endblock content_body %}

